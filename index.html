<!DOCTYPE html>
<html lang="it">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Gestione Spese</title>
    <meta name="apple-mobile-web-app-capable" content="yes">
    <meta name="apple-mobile-web-app-status-bar-style" content="black-translucent">
    <link rel="apple-touch-icon" href="icon.png"> <!-- Sostituisci con il percorso della tua icona -->

    <!-- Bootstrap CSS -->
    <link href="https://stackpath.bootstrapcdn.com/bootstrap/4.5.2/css/bootstrap.min.css" rel="stylesheet">

    <!-- DataTables CSS -->
    <link rel="stylesheet" href="https://cdn.datatables.net/1.10.24/css/jquery.dataTables.min.css">

    <!-- CSS Personalizzato -->
    <link rel="stylesheet" href="style.css">

    <!-- Chart.js -->
    <script src="https://cdn.jsdelivr.net/npm/chart.js"></script>

    <!-- Firebase App (sempre necessario) -->
    <script src="https://www.gstatic.com/firebasejs/8.10.0/firebase-app.js"></script>
    <!-- Firebase Authentication -->
    <script src="https://www.gstatic.com/firebasejs/8.10.0/firebase-auth.js"></script>
    <!-- Firebase Firestore -->
    <script src="https://www.gstatic.com/firebasejs/8.10.0/firebase-firestore.js"></script>

    <!-- jQuery e DataTables JS -->
    <script src="https://code.jquery.com/jquery-3.6.0.min.js"></script>
    <script src="https://cdn.datatables.net/1.10.24/js/jquery.dataTables.min.js"></script>

    <script>
        // Configurazione di Firebase
        var firebaseConfig = {
            apiKey: "AIzaSyA6usjd2E5ytJz8Mx9SqjQXGXPgnOAeqYw",
            authDomain: "gestione-spese-2-5db43.firebaseapp.com",
            projectId: "gestione-spese-2-5db43",
            storageBucket: "gestione-spese-2-5db43.appspot.com",
            messagingSenderId: "583349146945",
            appId: "1:583349146945:web:af0989d9c1889b1ef77dc0"
        };
        // Inizializza Firebase
        firebase.initializeApp(firebaseConfig);
        const db = firebase.firestore();
    </script>

    <script src="app.js"></script>
</head>
<body>
    <div class="container">
        <h1 class="text-center my-4">Gestione Spese</h1>

        <div class="button-container text-center mb-4">
            <button id="addExpenseBtn" class="btn btn-primary">Aggiungi Spesa</button>
        </div>

        <div id="auth-container"></div>

        <div id="content" style="display: none;">
            <div id="expenseFormContainer" class="card p-4 mb-4">
                <h2 class="card-title">Inserisci Nuova Spesa</h2>
                <form id="expenseForm" class="form-group">
                    <input type="text" id="description" class="form-control mb-3" placeholder="Descrizione spesa" required>
                    <input type="date" id="date" class="form-control mb-3" required>
                    <input type="number" id="totalAmount" class="form-control mb-3" placeholder="Importo totale" required>

                    <h3>Chi ha messo cosa:</h3>
                    <div id="payers">
                        <div class="form-row mb-3">
                            <label class="col-sm-4 col-form-label">Jack:</label>
                            <div class="col-sm-8">
                                <input type="number" id="jackAmount" class="form-control" placeholder="Importo messo da Jack" required>
                            </div>
                        </div>
                        <div class="form-row mb-3">
                            <label class="col-sm-4 col-form-label">Ste:</label>
                            <div class="col-sm-8">
                                <input type="number" id="steAmount" class="form-control" placeholder="Importo messo da Ste" required>
                            </div>
                        </div>
                    </div>

                    <h3>Divisione della spesa:</h3>
                    <div id="splitMethod" class="mb-3">
                        <label for="splitType">Tipo di divisione:</label>
                        <select id="splitType" class="form-control">
                            <option value="equally">Equamente</option>
                            <option value="exact">Importo esatto</option>
                        </select>
                    </div>

                    <div id="splitDetails" style="display:none;">
                        <div class="form-row mb-3">
                            <label class="col-sm-4 col-form-label">Importo per Jack:</label>
                            <div class="col-sm-8">
                                <input type="number" id="jackSplit" class="form-control" placeholder="Importo per Jack">
                            </div>
                        </div>
                        <div class="form-row mb-3">
                            <label class="col-sm-4 col-form-label">Importo per Ste:</label>
                            <div class="col-sm-8">
                                <input type="number" id="steSplit" class="form-control" placeholder="Importo per Ste">
                            </div>
                        </div>
                    </div>

                    <button type="submit" class="btn btn-success">Aggiungi Spesa</button>
                </form>
            </div>

            <h2 class="my-4">Elenco Spese</h2>
            <div id="totalBalance" class="balance-text"></div>

            <table id="expenseTable" class="table table-striped table-bordered">
                <thead>
                    <tr>
                        <th>Data</th>
                        <th>Descrizione</th>
                        <th>Totale</th>
                        <th>Jack (messo)</th>
                        <th>Ste (messo)</th>
                        <th>Jack (dovuto)</th>
                        <th>Ste (dovuto)</th>
                        <th>Azione</th>
                    </tr>
                </thead>
                <tbody id="expenseList"></tbody>
            </table>

            <h2 class="my-4">Statistiche delle Spese</h2>
            <canvas id="expenseChart" width="400" height="200"></canvas>
        </div>
    </div>
</body>
</html>
